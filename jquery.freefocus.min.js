!function(a){"use strict";function b(a,b){for(var c=0;c<a.length;c++){var d=b(a[c]);if(d)return d}}function c(c,d){var e=b(a.freefocus.hintSources,function(b){return e=a.trim(b(c,d)),e.length?e:void 0});if(e)return e=e.replace(/^([^#].*) ''$/,"#$1"),b(e.split(";"),function(b){if("none"===a.trim(b))return a();var c=a(b);return d.focusablesSelector&&(c=c.filter(d.focusablesSelector)),d.focusablesFilter&&(c=c.filter(d.focusablesFilter)),c.length?c:void 0})}function d(a){var b={};return a.split(";").forEach(function(a){var c=a.split(":");c[1]&&(b[c[0].trim()]=c[1].trim())}),b}function e(b,c,d){var e=k(b,d,d),f=a.freefocus.focusPoint;b.is(f.$el)||(f.$el=b,f.box={x:(e.x2-e.x1)/2,y:(e.y2-e.y1)/2}),f.updatedInDirection=m(o(f.box,e),c),f.updatedInDirection.fwd=l(e,c).fwd2}function f(b,c,d,e){var f=k(b,e,e),g=a.freefocus.focusPoint;g.$el=b;var h=l(f,c),i={fwd:h.fwd1,ort:q(g.updatedInDirection.ort,h.ort1,h.ort2)};g.box=p(n(i,c),f),d&&t(n(i,c),"#00f","entry focus point for "+b.html())}function g(b,c){var d=l(k(b,c.cache,c.cache),c.move);c.debug&&t(n(a.freefocus.focusPoint.updatedInDirection,c.move),"#0f0","exit focus point for "+b.html());var e,f=1/0,g=null;return c.targets?e=c.targets:(e=a(c.focusablesSelector,c.focusablesContext),c.focusablesFilter&&(e=e.filter(c.focusablesFilter))),e.each(function(){var e=a(this);if(!e.is(b)){var i=l(k(e,c.cache,c.cache),c.move);if(!(i.fwd1<d.fwd2)){var j=h(d,i);j<c.maxDistance&&f>j&&(g=e,f=j)}}}),c.debug&&g&&console.log("Distance from",b.get(0),"to",g.get(0),"is",f),g}function h(b,c){var d,e=a.freefocus.focusPoint.updatedInDirection,f={fwd:c.fwd1,ort:q(e.ort,c.ort1,c.ort2)},g=Math.abs(f.fwd-e.fwd),h=Math.abs(f.ort-e.ort);d=f.ort===e.ort?0:Math.sqrt(g*g+h*h);var j=i(b,c);return d+g+2*h-Math.sqrt(j)}function i(a,b){var c={ort1:a.ort1,ort2:a.ort2};b.ort1>c.ort1&&(c.ort1=b.ort1),b.ort2<c.ort2&&(c.ort2=b.ort2);var d=c.ort2-c.ort1;return 0>d&&(d=0),d}function j(a){var b=a.offset();return{x1:b.left,y1:b.top,x2:b.left+a.innerWidth(),y2:b.top+a.innerHeight()}}function k(a,b,c){var d;return b&&(d=a.data("freefocus-dimensions")),d||(d=j(a)),c&&a.data("freefocus-dimensions",d),d}function l(a,b){var c=m({x:a.x1,y:a.y1},b),d=m({x:a.x2,y:a.y2},b);return{fwd1:Math.min(c.fwd,d.fwd),ort1:Math.min(c.ort,d.ort),fwd2:Math.max(c.fwd,d.fwd),ort2:Math.max(c.ort,d.ort)}}function m(a,b){switch(b){case"left":return{fwd:-a.x,ort:-a.y};case"right":return{fwd:a.x,ort:a.y};case"down":return{fwd:a.y,ort:-a.x};case"up":return{fwd:-a.y,ort:a.x}}}function n(a,b){switch(b){case"left":return{x:-a.fwd,y:-a.ort};case"right":return{x:a.fwd,y:a.ort};case"down":return{x:-a.ort,y:a.fwd};case"up":return{x:a.ort,y:-a.fwd}}}function o(a,b){return{x:a.x+b.x1,y:a.y+b.y1}}function p(a,b){return{x:a.x-b.x1,y:a.y-b.y1}}function q(a,b,c){return Math.min(Math.max(a,b),c)}function r(b){var c=a(b.focusablesSelector,b.focusablesContext);b.focusablesFilter&&(c=c.filter(b.focusablesFilter)),c.each(function(){k(a(this),!0,!0)})}function s(){a(".freefocus-debug").remove()}function t(b,c,d){a('<div class="freefocus-debug"></div>').appendTo(a("body")).css({position:"absolute",left:b.x-3,top:b.y-3,width:6,height:6,background:c,"border-radius":3}).attr("title",d)}function u(){x.on.apply(x,arguments),w.push(arguments)}function v(){w.forEach(function(a){x.off.apply(x,a)}),w=[]}a.freefocus=function(b,c){if("remove"===b)return v(),void 0;if("cache"===b)return r(c),void 0;b=a.extend({},a.freefocus.setupOptions,b);var d=function(d){var e=a.extend({},c,{move:d});a(b.focusedSelector).freefocus(e)};if("number"==typeof b.throttle&&(d=_.throttle(d,b.throttle)),u("keydown",function(b){var c=a.freefocus.keys[b.which];c&&(b.preventDefault(),d(c))}),b.hoverFocus){if(!c.focusablesSelector)throw new Error("focusablesSelector is required for hoverFocus");u("mouseenter",c.focusablesSelector,function(){var d=(c||{}).trigger||a.freefocus.moveOptions.trigger,e=a(this);return b.focusablesFilter&&(e=e.filter(b.focusablesFilter)),e.trigger(d)})}},a.fn.freefocus=function(b,d){if("dimensions"===b){var h=k(this,!0,!1);return{left:h.x1,top:h.y1,width:h.x2-h.x1,height:h.y2-h.y1}}if("moved"===b)return this.data("freefocus-dimensions",null),void 0;if("nav"===b){var i=this;return"clear"===d?a.each(a.freefocus.moves,function(a){i.removeAttr("data-nav-"+a)}):a.each(d,function(a,b){i.attr("data-nav-"+a,b)}),void 0}if(b=a.extend({},a.freefocus.moveOptions,b),null===a.freefocus.moves[b.move])throw new Error('Unknown move direction "'+b.move+'"');if(!b.targets&&!b.focusablesSelector)throw new Error("Options should contain either focusablesSelector or targets");if(b.targets&&!(b.targets instanceof a))throw new Error("Argument targets should be a jQuery object");if(this.size()>1)throw new Error("Can't move from multiple elements");if(!this.size())return this;b.debug&&s(),e(this,b.move,b.cache);var j=c(this,b);return j?j.length>1&&(j=g(this,a.extend({},b,{targets:j}))):j=g(this,b),j&&j.length?(f(j,b.move,b.debug,b.cache),b.preTrigger&&j.trigger(b.preTrigger),j.trigger(b.trigger),this):this},a.freefocus.moveOptions={focusablesSelector:["a[href]","area[href]","input:enabled","select:enabled","textarea:enabled","button:enabled","iframe","object","embed","*[tabindex]","*[contenteditable]"].join(", "),focusablesFilter:":visible",focusablesContext:void 0,trigger:"focus",preTrigger:!1,debug:!1,maxDistance:1/0},a.freefocus.setupOptions={focusedSelector:":focus",hoverFocus:!1,throttle:!1},a.freefocus.keys={37:"left",38:"up",39:"right",40:"down"},a.freefocus.moves={left:{},right:{},up:{},down:{}},a.freefocus.focusPoint={},a.freefocus.hintSources=[function(a,b){return a.attr("data-nav-"+b.move)},function(a,b){var c="nav"+b.move.charAt(0).toUpperCase()+b.move.slice(1);return a.get(0).style[c]},function(a,b){return d(a.attr("style")||"")["nav-"+b.move]}];var w=[],x=a(document)}(jQuery);