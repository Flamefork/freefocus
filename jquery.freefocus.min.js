!function(a){"use strict";function b(b,d){var e=b.get(0).style["nav"+d.move.charAt(0).toUpperCase()+d.move.slice(1)]||c(b.attr("style")||"")["nav-"+d.move];if(e){if(0===e.indexOf("#"))return a(e);throw new Error("Invalid nav-"+d.move+" selector '"+e+"': only #id allowed.")}}function c(a){var b={};return a.split(";").forEach(function(a){var c=a.split(":");c[1]&&(b[c[0].trim()]=c[1].trim())}),b}function d(b,c){var d=i(b),e=a.freefocus.focusPoint;b.is(e.$el)||(e.$el=b,e.box={x:(d.x2-d.x1)/2,y:(d.y2-d.y1)/2}),e.updatedInDirection=k(m(e.box,d),c),e.updatedInDirection.fwd=j(d,c).fwd2}function e(b,c,d){var e=i(b),f=a.freefocus.focusPoint;f.$el=b;var g=j(e,c),h={fwd:g.fwd1,ort:o(f.updatedInDirection.ort,g.ort1,g.ort2)};f.box=n(l(h,c),e),d&&q(l(h,c),"#00f","entry focus point for "+b.html())}function f(b,c){var d=j(i(b),c.move);c.debug&&q(l(a.freefocus.focusPoint.updatedInDirection,c.move),"#0f0","exit focus point for "+b.html());var e=1/0,f=null;return c.targets.each(function(){var h=a(this);if(!h.is(b)){var k=j(i(h),c.move);if(!(k.fwd2<=d.fwd2)){var l=g(d,k);l<c.maxDistance&&e>l&&(f=h,e=l)}}}),c.debug&&f&&console.log("Distance from",b.get(0),"to",f.get(0),"is",e),f}function g(b,c){var d,e=a.freefocus.focusPoint.updatedInDirection,f={fwd:c.fwd1,ort:o(e.ort,c.ort1,c.ort2)},g=Math.abs(f.fwd-e.fwd),i=Math.abs(f.ort-e.ort);d=f.ort===e.ort?0:Math.sqrt(g*g+i*i);var j=h(b,c);return d+g+2*i-Math.sqrt(j)}function h(a,b){var c={ort1:a.ort1,ort2:a.ort2};b.ort1>c.ort1&&(c.ort1=b.ort1),b.ort2<c.ort2&&(c.ort2=b.ort2);var d=c.ort2-c.ort1;return 0>d&&(d=0),d}function i(a){if(!a.box){var b=a.offset();a.box={x1:b.left,y1:b.top,x2:b.left+a.outerWidth(),y2:b.top+a.outerHeight()}}return a.box}function j(a,b){var c=k({x:a.x1,y:a.y1},b),d=k({x:a.x2,y:a.y2},b);return{fwd1:Math.min(c.fwd,d.fwd),ort1:Math.min(c.ort,d.ort),fwd2:Math.max(c.fwd,d.fwd),ort2:Math.max(c.ort,d.ort)}}function k(a,b){switch(b){case"left":return{fwd:-a.x,ort:-a.y};case"right":return{fwd:a.x,ort:a.y};case"down":return{fwd:a.y,ort:-a.x};case"up":return{fwd:-a.y,ort:a.x}}}function l(a,b){switch(b){case"left":return{x:-a.fwd,y:-a.ort};case"right":return{x:a.fwd,y:a.ort};case"down":return{x:-a.ort,y:a.fwd};case"up":return{x:a.ort,y:-a.fwd}}}function m(a,b){return{x:a.x+b.x1,y:a.y+b.y1}}function n(a,b){return{x:a.x-b.x1,y:a.y-b.y1}}function o(a,b,c){return Math.min(Math.max(a,b),c)}function p(){a(".freefocus-debug").remove()}function q(b,c,d){a('<div class="freefocus-debug"></div>').appendTo(a("body")).css({position:"absolute",left:b.x-3,top:b.y-3,width:6,height:6,background:c,"border-radius":3}).attr("title",d)}function r(){u.on.apply(u,arguments),t.push(arguments)}function s(){t.forEach(function(a){u.off.apply(u,a)}),t=[]}a.freefocus=function(b,c){if("remove"===b)return s(),void 0;b=a.extend({},a.freefocus.setupOptions,b);var d=function(d){var e=a.extend({},c,{move:d,targets:a(b.focusablesSelector)});a(b.focusedSelector).freefocus(e)};b.throttle!==!1&&(d=_.throttle(d,b.throttle)),r("keydown",function(b){var c=a.freefocus.keys[b.which];c&&(b.preventDefault(),d(c))}),b.hoverFocus&&r("mouseenter",b.focusablesSelector,function(){var b=(c||{}).trigger||a.freefocus.moveOptions.trigger;return a(this).trigger(b)})},a.fn.freefocus=function(c){if(c=a.extend({},a.freefocus.moveOptions,c),null===a.freefocus.moves[c.move])throw new Error("Unknown move direction '"+c.move+"'");if(!(c.targets instanceof a))throw new Error("Argument targets should be a jQuery object");if(this.size()>1)throw new Error("Can't move from multiple elements");if(!this.size())return this;c.debug&&p(),d(this,c.move);var g=b(this,c)||f(this,c);return g?(e(g,c.move,c.debug),g.trigger(c.trigger),this):this},a.freefocus.moveOptions={trigger:"focus",weightFn:a.freefocus.weightFn,debug:!1,useNavProps:!0,maxDistance:1/0},a.freefocus.setupOptions={focusablesSelector:["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","*[tabindex]","*[contenteditable]"].join(", "),focusedSelector:":focus",hoverFocus:!1,throttle:!1},a.freefocus.keys={37:"left",38:"up",39:"right",40:"down"},a.freefocus.moves={left:{},right:{},up:{},down:{}},a.freefocus.focusPoint={};var t=[],u=a(document)}(jQuery);