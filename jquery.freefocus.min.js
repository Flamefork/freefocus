!function(a){"use strict";function b(b){var c;if(!b.focusablesSelector)return console.error("Options should contain either focusablesSelector or targets"),[];if(b.hintSelector){var d=b.ignoreContextForHints?void 0:b.focusablesContext;c=a(b.hintSelector,d).filter(b.focusablesSelector)}else c=a(b.focusablesSelector,b.focusablesContext);return b.focusablesFilter&&(c=c.filter(b.focusablesFilter)),c.toArray()}function c(a,b){for(var c=0;c<a.length;c++){var d=b(a[c]);if(d)return d}}function d(d,e){var f=c(a.freefocus.hintSources,function(b){return a.trim(b(d,e))});return f?"none"===f?[]:(f=f.replace(/^([^#].*) ''$/,"#$1"),c(f.split(/\s*;\s*/),function(c){if(!c)return void 0;var d=a.isFunction(e.targets)?e.targets:b,f=d(a.extend({},e,{hintSelector:c,focusablesContext:e.focusablesContext}));return f.length?f:void 0})):void 0}function e(a){var b={};return a.split(";").forEach(function(a){var c=a.split(":");c[1]&&(b[c[0].trim()]=c[1].trim())}),b}function f(b,c,d){var e=l(b,d,d),f=a.freefocus.focusPoint;b!==f.el&&(f.el=b,f.box={x:(e.x2-e.x1)/2,y:(e.y2-e.y1)/2}),f.updatedInDirection=n(p(f.box,e),c),f.updatedInDirection.fwd=m(e,c).fwd2}function g(b,c,d,e){var f=l(b,e,e),g=a.freefocus.focusPoint;g.el=b;var h=m(f,c),i={fwd:h.fwd1,ort:r(g.updatedInDirection.ort,h.ort1,h.ort2)};g.box=q(o(i,c),f),d&&u(o(i,c),"#00f","entry focus point for "+b.innerHTML)}function h(b,c){var d=m(l(b,c.cache,c.cache),c.move);c.debug&&u(o(a.freefocus.focusPoint.updatedInDirection,c.move),"#0f0","exit focus point for "+b.innerHTML);var e=c.targets;a.isFunction(e)&&(e=e(c));var f=1/0,g=null;return a.each(e,function(a,e){if(e!==b){var h=m(l(e,c.cache,c.cache),c.move);if(!(h.fwd1<d.fwd2)){var j=i(d,h);j<c.maxDistance&&f>j&&(g=e,f=j)}}}),c.debug&&g&&console.log("Distance from",b,"to",g,"is",f),g}function i(b,c){var d,e=a.freefocus.focusPoint.updatedInDirection,f={fwd:c.fwd1,ort:r(e.ort,c.ort1,c.ort2)},g=Math.abs(f.fwd-e.fwd),h=Math.abs(f.ort-e.ort);d=f.ort===e.ort?0:Math.sqrt(g*g+h*h);var i=j(b,c);return d+g+2*h-Math.sqrt(i)}function j(a,b){var c={ort1:a.ort1,ort2:a.ort2};b.ort1>c.ort1&&(c.ort1=b.ort1),b.ort2<c.ort2&&(c.ort2=b.ort2);var d=c.ort2-c.ort1;return 0>d&&(d=0),d}function k(a){var b=a.getBoundingClientRect();return{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom}}function l(b,c,d){var e;return c&&(e=a.data(b,"freefocus-dimensions")),e||(e=k(b)),d&&a.data(b,"freefocus-dimensions",e),e}function m(a,b){var c=n({x:a.x1,y:a.y1},b),d=n({x:a.x2,y:a.y2},b);return{fwd1:Math.min(c.fwd,d.fwd),ort1:Math.min(c.ort,d.ort),fwd2:Math.max(c.fwd,d.fwd),ort2:Math.max(c.ort,d.ort)}}function n(a,b){switch(b){case"left":return{fwd:-a.x,ort:-a.y};case"right":return{fwd:a.x,ort:a.y};case"down":return{fwd:a.y,ort:-a.x};case"up":return{fwd:-a.y,ort:a.x}}}function o(a,b){switch(b){case"left":return{x:-a.fwd,y:-a.ort};case"right":return{x:a.fwd,y:a.ort};case"down":return{x:-a.ort,y:a.fwd};case"up":return{x:a.ort,y:-a.fwd}}}function p(a,b){return{x:a.x+b.x1,y:a.y+b.y1}}function q(a,b){return{x:a.x-b.x1,y:a.y-b.y1}}function r(a,b,c){return Math.min(Math.max(a,b),c)}function s(b){b=a.extend({},a.freefocus.cacheOptions,b);var c=b.targets;a.isFunction(c)&&(c=c(b)),a.each(c,function(a,b){l(b,!0,!0)})}function t(){a(".freefocus-debug").remove()}function u(b,c,d){a('<div class="freefocus-debug"></div>').appendTo(a("body")).css({position:"absolute",left:b.x-3,top:b.y-3,width:6,height:6,background:c,"border-radius":3}).attr("title",d)}function v(){z.on.apply(z,arguments),y.push(arguments)}function w(){y.forEach(function(a){z.off.apply(z,a)}),y=[]}function x(b,c){if(document.createEvent&&b.dispatchEvent&&"focus"!==c){var d=document.createEvent("Event");d.initEvent(c,!0,!0),b.dispatchEvent(d)}else a(b).trigger(a.Event(c))}a.freefocus=function(b,c){if("remove"===b)return w(),void 0;if("cache"===b)return s(c),void 0;b=a.extend({},a.freefocus.setupOptions,b);var d=function(d){var e=a.extend({},c,{move:d});a(b.focusedSelector).freefocus(e)};"number"==typeof b.throttle&&(d=_.throttle(d,b.throttle)),v("keydown",function(b){var c=a.freefocus.keys[b.which];c&&(b.preventDefault(),d(c))}),b.hoverFocus&&(c.focusablesSelector||(console.error("focusablesSelector is required for hoverFocus"),c.focusablesSelector="zzz"),v("mouseenter",c.focusablesSelector,function(){var d=(c||{}).trigger||a.freefocus.moveOptions.trigger,e=a(this);return b.focusablesFilter&&(e=e.filter(b.focusablesFilter)),e.trigger(d)}))},a.fn.freefocus=function(b,c){if("dimensions"===b){if(!this.length)return console.error("Can't get freefocus dimensions for empty jQuery object"),{left:0,top:0,width:0,height:0};this.length>1&&console.error("Can't use freefocus on multiple element jQuery object");var e=l(this[0],!0,!1);return{left:e.x1,top:e.y1,width:e.x2-e.x1,height:e.y2-e.y1}}if("moved"===b)return this.removeData("freefocus-dimensions"),void 0;if("nav"===b){var i=this;return"clear"===c?a.each(a.freefocus.moves,function(a){i.removeAttr("data-nav-"+a)}):a.each(c,function(a,b){i.attr("data-nav-"+a,b)}),void 0}if(!this.length)return b.debug&&console.warn("freefocus called on empty jQuery object"),this;this.length>1&&console.error("Can't use freefocus on multiple element jQuery object");var j=this[0];if(b=a.extend({},a.freefocus.moveOptions,b),null===a.freefocus.moves[b.move])return console.error('Unknown move direction "'+b.move+'"'),this;a.isFunction(b.targets)||a.isArray(b.targets)||b.targets.jquery||console.warn("Argument targets should be a function, array, or jQuery object"),b.debug&&t(),f(j,b.move,b.cache);var k,m=d(j,b);return(k=m?m.length>1?h(j,a.extend({},b,{targets:m})):m[0]:h(j,b))?(g(k,b.move,b.debug,b.cache),b.preTrigger&&x(k,b.preTrigger),b.trigger&&x(k,b.trigger),a(k)):this},a.freefocus.moveOptions={targets:b,focusablesSelector:["a[href]","area[href]","input:enabled","select:enabled","textarea:enabled","button:enabled","iframe","object","embed","*[tabindex]","*[contenteditable]"].join(", "),focusablesFilter:":visible",focusablesContext:void 0,ignoreContextForHints:!0,trigger:"focus",preTrigger:!1,debug:!1,maxDistance:1/0},a.freefocus.setupOptions={focusedSelector:":focus",hoverFocus:!1,throttle:!1},a.freefocus.cacheOptions={targets:b},a.freefocus.keys={37:"left",38:"up",39:"right",40:"down"},a.freefocus.moves={left:{},right:{},up:{},down:{}},a.freefocus.focusPoint={},a.freefocus.hintSources=[function(a,b){return a.getAttribute("data-nav-"+b.move)},function(a,b){var c="nav"+b.move.charAt(0).toUpperCase()+b.move.slice(1);return a.style[c]},function(b,c){var d=a.trim(b.getAttribute("style"));return d&&e(d)["nav-"+c.move]}];var y=[],z=a(document)}(jQuery);